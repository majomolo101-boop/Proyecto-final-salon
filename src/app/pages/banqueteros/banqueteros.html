<div class="banquetero-container">
  <h1 class="title">Banqueteros</h1>

  <!-- MENSAJE DE ÉXITO -->
  <span class="toast-message" *ngIf="message">{{ message }}</span>

  <!-- Crear y Buscar -->
  <div class="top-controls">
    <button class="btn-create" (click)="handleCreateNew()">Crear +</button>

    <div class="search-wrapper">
      <input
        type="text"
        class="search-input"
        placeholder="Buscar"
        [(ngModel)]="searchTerm"
        (input)="handleSearch()"
      />
      <i class="fa fa-search search-icon"></i>
    </div>
  </div>

  <!-- MENSAJE DE RESULTADOS DE BÚSQUEDA -->
  <div class="search-result-message" *ngIf="searchTerm !== ''">
    <span *ngIf="filteredBanqueteros.length > 0">
      {{ filteredBanqueteros.length }} resultado(s) encontrado(s)
    </span>
    <span *ngIf="filteredBanqueteros.length === 0">
      No se encontraron resultados para "{{ searchTerm }}"
    </span>
  </div>

  <!-- FORMULARIO MODAL -->
  <div class="form-modal" *ngIf="showForm">
    <div class="form-container">
      <div class="form-header">
        <h2>{{ editingId ? 'Editar Banquetero' : 'Nuevo Banquetero' }}</h2>
      </div>

      <form (ngSubmit)="handleSave()" class="form-content">
        <div class="form-grid">
          <div class="form-group">
            <label>Nombre</label>
            <input type="text" [(ngModel)]="formData.nombre" name="nombre" required />
          </div>

          <div class="form-group">
            <label>Apellido</label>
            <input type="text" [(ngModel)]="formData.apellido" name="apellido" required />
          </div>

          <div class="form-group">
            <label>Tipo de evento</label>
            <input type="text" [(ngModel)]="formData.tipo_evento" name="tipo_evento" required />
          </div>

          <div class="form-group">
            <label>Fecha del evento</label>
            <input type="date" [(ngModel)]="formData.fechaEvento" name="fechaEvento" required />
          </div>

          <div class="form-group">
            <label>Teléfono</label>
            <input type="tel" [(ngModel)]="formData.telefono" name="telefono" required />
          </div>

          <div class="form-group">
            <label>Email</label>
            <input type="email" [(ngModel)]="formData.email" name="email" required />
          </div>

          <div class="form-group">
            <label>Número de personas</label>
            <input type="number" [(ngModel)]="formData.numeroPersonas" name="numeroPersonas" required />
          </div>

          <div class="form-group">
            <label>Hora de entrada</label>
            <input type="time" [(ngModel)]="formData.fechaEntrada" name="fechaEntrada" required />
          </div>

          <div class="form-group">
            <label>Hora de salida</label>
            <input type="time" [(ngModel)]="formData.fechaSalida" name="fechaSalida" required />
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="handleCancel()">Cancelar</button>
          <button type="submit" class="btn-save">
            {{ editingId ? 'Actualizar' : 'Guardar' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- MENSAJE CUANDO NO HAY BANQUETEROS -->
  <div class="empty-state" *ngIf="banqueteros.length === 0 && !showForm">
    <p class="empty-title">No hay banqueteros registrados</p>
    <p class="empty-subtitle">Crea uno nuevo para comenzar</p>
  </div>

  <!-- LISTA DE BANQUETEROS -->
  <div class="clients-list" *ngIf="filteredBanqueteros.length > 0">
    <div
      class="client-card"
      *ngFor="let b of filteredBanqueteros"
      [class.expanded]="expandedId === b.id"
    >
      <!-- RESUMEN -->
      <div class="client-summary" (click)="handleToggleExpand(b.id)">
        <h3>{{ b.nombre }} {{ b.apellido }}</h3>
        <p><strong>Tipo de evento:</strong> {{ b.tipo_evento }}</p>
      </div>

      <!-- DETALLES EXPANDIDOS -->
      <div class="client-details" *ngIf="expandedId === b.id">
        <div class="detail"><span>Fecha:</span> {{ b.fechaEvento }}</div>
        <div class="detail"><span>Hora entrada:</span> {{ convertToAMPM(b.fechaEntrada) }}</div>
        <div class="detail"><span>Hora salida:</span> {{ convertToAMPM(b.fechaSalida) }}</div>
        <div class="detail"><span>Teléfono:</span> {{ b.telefono }}</div>
        <div class="detail"><span>Email:</span> {{ b.email }}</div>
        <div class="detail"><span>Número de personas:</span> {{ b.numeroPersonas }}</div>

        <!-- ICONOS EDITAR / ELIMINAR -->
        <div class="client-actions">
          <button class="icon-btn edit" (click)="handleEdit(b); $event.stopPropagation()">
            <i class="fa-solid fa-pen-to-square"></i>
          </button>

          <button class="icon-btn delete" (click)="handleDelete(b.id); $event.stopPropagation()">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
